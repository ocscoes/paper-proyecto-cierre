<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>antecedentes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="02-antecedentes_files/libs/clipboard/clipboard.min.js"></script>
<script src="02-antecedentes_files/libs/quarto-html/quarto.js"></script>
<script src="02-antecedentes_files/libs/quarto-html/popper.min.js"></script>
<script src="02-antecedentes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="02-antecedentes_files/libs/quarto-html/anchor.min.js"></script>
<link href="02-antecedentes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="02-antecedentes_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="02-antecedentes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="02-antecedentes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="02-antecedentes_files/libs/bootstrap/bootstrap-c0367b04c37547644fece4185067e4a7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="qué-es-la-cohesión-social" class="level1">
<h1>¿Qué es la cohesión social?</h1>
<p>Aunque sus raíces teóricas se remontan a los inicios de la teoría social – y su uso extendido en la discusión pública - definir cohesión social sigue siendo una tarea difícil <span class="citation" data-cites="chan_reconsidering_2006">[@chan_reconsidering_2006]</span>. Situada en la intersección entre enfoques teóricos y descriptivos que enfatizan las cooperación y la integración, y consideraciones normativas acerca de cómo la sociedades se mantienen unidad ante crisis, tensiones y transformaciones, la cohesión social se ha definido de múltiples maneras, reflejando diversas perspectivas, alcances e indicadores <span class="citation" data-cites="chan_reconsidering_2006 castillo_conceptos_2021">[@chan_reconsidering_2006; @castillo_conceptos_2021]</span>.</p>
<p>Con todo, la mayoría de las definiciones comparten algunos elementos en común <span class="citation" data-cites="castillo_conceptos_2021">[@castillo_conceptos_2021]</span>:</p>
<ul>
<li>Es un atributo del colectivo, no de los individuos.</li>
<li>Es un constructo multidimensional</li>
<li>Es una cualidad de las relaciones sociales que permite alcanzar fines compartidos.</li>
<li>Dado que los sujetos tiene un objetivo común, son capaces cooperar para lograr estos objetivos.</li>
</ul>
<p>Una definición robusta de cohesión social debe integrar estos elementos. A la vez, debe ser una definición mínima e intuitiva, que permita su operacionalización y medición, así como la comparación en contextos diversos y posibilite la discusión e espacios públicos <span class="citation" data-cites="chan_reconsidering_2006">[@chan_reconsidering_2006]</span>.</p>
<p>De tal modo, en este artículo partiremos de la definición propuesta por Chan, To y Chan <span class="citation" data-cites="chan_reconsidering_2006">[-@chan_reconsidering_2006, p.90]</span>, para quienes la cohesión social</p>
<blockquote class="blockquote">
<p>is a state of aﬀairs concerning both the vertical and the horizontal interactions among members of society as characterized by a set of attitudes and norms that includes trust, a sense of belonging and the willingness to participate and help, as well as their behavioural manifestations.</p>
</blockquote>
<p>De la definición, pues, se desprenden dos dimensiones principales. En primer lugar, la cohesión social tiene <strong>una dimensión horizontal</strong>. Con esto nos referimos a las interacciones cotidianas entre los miembros de una sociedad. Contiene aspectos subjetivos (tales como el sentido de pertenencia y la confianza interpersonal), como aspecto objetivos, como las redes sociales y las condiciones materiales que facilitan o dificultan estas interacciones.</p>
<p>En segundo lugar, la cohesión social tiene <strong>una dimensión vertical</strong>, que se refiere a las relaciones entre los individuos y las instituciones sociales y políticas. Esta dimensión incluye aspectos como la confianza en las instituciones, la legitimidad del sistema político y la participación cívica.</p>
</section>
<section id="tendencias-y-factores-relacionados-a-la-cohesión-social" class="level1">
<h1>Tendencias y factores relacionados a la Cohesión Social</h1>
<p>Diversos estudios muestran que las trayectorias de la cohesión social difieren ampliamente entre países. Entre los factores que influyen en estas trayectorias se cuentan el crecimiento y la desigualdad económica, la configuración de los sistemas de bienestar, la composición cultural y étnica, y los legados autoritatorios. La intensidad y la dirección de sus efectos, sin embargo, dependen en gran medida del contexto. Por ejemplo, mientras en Europa el crecimiento económico, la igualdad social y las democracias liberales suelen asociarse con mayores niveles de cohesión, en varios países de Asia se observan niveles comparables en contextos de desigualdad moderada y regímenes autoritarios. Ahora bien, en todos estos estudios las menciones a determinantes de la cohesión social en sociedades latinoamericanas son escasas.</p>
<p>Con todo, es posible agrupar los factores identificados en tres dimensiones:</p>
<ol type="1">
<li>Factores socioeconómicos</li>
<li>Factores institucionales</li>
<li>Factores culturales</li>
</ol>
<p>A continuación se revisan cada una de ellas.</p>
<section id="factores-socioeconómicos" class="level2">
<h2 class="anchored" data-anchor-id="factores-socioeconómicos">1) Factores socioeconómicos</h2>
<p>La prosperidad económica, a menudo medida a través del PIB per cápita, se ha asociado con mayores niveles de cohesión social. Esta asociación se ha encontrando en diversos contextos culturales <span class="citation" data-cites="janmaat_social_2010 delhey_social_2023">[@janmaat_social_2010; @delhey_social_2023]</span>, aunque parece atenuarse en algunas sociedades asiáticas de altos ingresos <span class="citation" data-cites="delhey_social_2018">[@delhey_social_2018]</span>. Estos hallazgos van en línea con las perspectivas universalistas o modernistas de la cohesión social, para quienes la cohesión es un fenómeno estrechamente relacionado con distintas etapas del desarrollo socioeconómico <span class="citation" data-cites="janmaat_social_2010">[@janmaat_social_2010]</span>.</p>
<p>Por otro lado, la desigualdad económica se ha asociado generalmente con menores niveles de cohesión social <span class="citation" data-cites="delhey_social_2018 janmaat_social_2010">[@delhey_social_2018; @janmaat_social_2010]</span>. Nuevamente, sin embargo, la asociación se atenúa en sociedades asiáticas, donde niveles medios de desigualdad están asociados con mayores niveles de cohesión <span class="citation" data-cites="janmaat_social_2010 delhey_social_2018">[@janmaat_social_2010; @delhey_social_2018]</span>.</p>
<p>No hay evidencia sobre como los niveles de desigualdad en América Latina se relacionan con la cohesión social. Por un lado, pese a ser considerada una de las regiones más desiguales del mundo, los latinoamericanos muestran altísimas expectativas de movilidad social <span class="citation" data-cites="somma_paradojas_2015">[@somma_paradojas_2015]</span>, posiblemente debido de la cobertura educativa en muchos países de la región o al predominio de las justificaciones meritocráticas para la desigualdad educativa y económica<span class="citation" data-cites="somma_paradojas_2015 castillo_socialization_2024">[@somma_paradojas_2015; @castillo_socialization_2024]</span>. Con todo, las demandas de mayor igualdad, redistribución y trato justo <span class="citation" data-cites="cabib_nuestras_2025 araujo_primer_2022">[@cabib_nuestras_2025; @araujo_primer_2022]</span>, que se han traducido en protestas masivas en varios países de la región, sugieren que la desigualdad económica es un factor relevante para la cohesión social en América Latina.</p>
</section>
<section id="factores-institucionales" class="level2">
<h2 class="anchored" data-anchor-id="factores-institucionales">2) Factores institucionales</h2>
<p>La capacidad del Estado para responder de manera efectiva a las problemáticas de la población, especialmente de los grupos más vulnerables, ha sido identificada como una de las principales fuentes de cohesión social en diversas sociedades <span class="citation" data-cites="kustov_diversity_2024 njozela_measuring_2016 andrews_welfare_2015">[@kustov_diversity_2024; @njozela_measuring_2016; @andrews_welfare_2015]</span>. En esta línea, una gobernanza efizacaz y la rpesencia de instituciones sólidas suelen asociarse con mayores niveles de cohesión soical en contextos tan diversos como Asia, América Latina y Europa <span class="citation" data-cites="delhey_social_2018 green_social_2011">[@delhey_social_2018; @green_social_2011]</span>.</p>
<p>En contraste, la relación entre los sistemas políticos y el régimen democrático con la cohesión social parecer ser más dependiente del contexto. Mientras que en sociedades occidentales de altos ingresos la democracia liberal tiende a reforzar los niveles de cohesión social, en algunos países asiáticos los regímenes autoritarios se han viculado con niveles igualmente elevados de cohesión <span class="citation" data-cites="delhey_social_2018">[@delhey_social_2018]</span></p>
<p>En América Latina, los Estados suelen caracterizarse por menores niveles de eficiencia y mayores índices de corrupción, acompañados de una ciudadnaía que presenta bajos niveles de confianza en las instituciones políticas y una menor participación en comparación con el mundo desarrollado. Sin embargo, esta desconfianza institucional convive con un fuerte sentido de identificación nacional, incluso más pronunciado que en el primer mundo <span class="citation" data-cites="somma_paradojas_2015">[@somma_paradojas_2015]</span>. Para Somma <span class="citation" data-cites="somma_paradojas_2015">[-@somma_paradojas_2015]</span>, esta aparente paradoja se relaciona con la propensión de las sociedades latinoamericanas hacia liderazgos personalistas y populistas. En este contexto, en línea con lo que Guillermo O’Donnell describió como democracias delegativas <span class="citation" data-cites="toppi_guillermo_2018">[@toppi_guillermo_2018]</span>, amplios sectores de la ciudadanía estarían dispuestos a transar principios de la democracia liberal en favor a liderazgos autoritarios cuando perciben que las instituciones democráticas no logran resolver sus problemas cotidianos. Esto sugiere que la efectividad de la gobernanza – más que el tipo de régimen político – es el factor institucional que ejerce un mayor peso en los niveles de cohesión social en las sociedades latinoamericanas.</p>
</section>
<section id="factores-culturales" class="level2">
<h2 class="anchored" data-anchor-id="factores-culturales">3) Factores culturales</h2>
<p>Las variables culturales y demográficas, incluidas las identidades étnicas, religiosas y nacionales, han mostrado efectos complejos sobre niveles de cohesión social, variando sustancialmente según el contexto. Este carácter contextual es especialmente evidente en el impacto de la diversidad étnica sobre la cohesión social.</p>
<p>Por un lado, diversos estudios han identificados esfectos negativos de la diversidad étnica sobre indicadores como el sentido de pertenencia o la fortaleza de las redes vecinales<span class="citation" data-cites="gijsberts_hunkering_2011 ariely_does_2013">[@gijsberts_hunkering_2011; @ariely_does_2013]</span>, asociación que resulta particularmente marcada en contexto de alta segregación racial, como el de los Estados Unidos <span class="citation" data-cites="meer_ethnic_2014">[@meer_ethnic_2014]</span>. No obstante, otros trabajos han mostrado que factores institucionales y la implementación de políticas inclusivas pueden moderar, o incluso invertir, esta relación <span class="citation" data-cites="meer_ethnic_2014 kustov_diversity_2024 delhey_social_2018 reeskens_nationalism_2012">[@meer_ethnic_2014; @kustov_diversity_2024; @delhey_social_2018; @reeskens_nationalism_2012]</span>.</p>
<p>La gestión de la diversidad étnica en Europa y América del Norte constrasta de manera importante con la realidad latinoamericana, caracterizada por una mayor heterogeneidad étnica y lingüistica. Pese a episodios de conflictividad derivados de las relacioens entre los Estados y los pueblos indígenas, los países latinoamericanos han demostrados fuertes identidades nacionales <span class="citation" data-cites="somma_paradojas_2015">[@somma_paradojas_2015]</span>.</p>
<p>Sin embargo, los cambios recientes en los patrones migratorios, que han favorecido la migración intrarregional tanto en términos relativos como absolutos <span class="citation" data-cites="stefoni_panorama_2018">[@stefoni_panorama_2018]</span>, podrían constituir nuevas fuentes de tensión para la cohesión social en las sociedades latinoamericanas. Aunque los latinoamericanos tienden a mostrar niveles de tolerancia étnico-religiosa y nacional superiores a los observados en varios países europeos <span class="citation" data-cites="somma_paradojas_2015">[@somma_paradojas_2015]</span>, casos como el chileno —frente a la migración masiva de población venezolana— evidencian signos de deterioro en las relaciones entre migrantes y no migrantes durante los últimos años <span class="citation" data-cites="castillo_social_2023">[@castillo_social_2023]</span>.</p>
<p>El efecto de la religiosidad sobre la cohesión social también ha sido objeto de estudio. Una mayor religiosidad y heterogeneidad religiosa puede estar asociada a mayores niveles de confianza interpersonal y participación cívica <span class="citation" data-cites="schnabel_god_2014">[@schnabel_god_2014]</span>. Estos hallazgos se centran principalmente en el contexto cultural europeo, y no se refieren a la realidad latinoamericana, donde el catolicisimo ha sido la religión predominante en la mayoría de los países del continente desde la colonización española y portuguesa. Sin embargo, debido al auge del pentecostalismo (como en Brasil o en los países centroamericanos) y al crecimiento de la población no religiosa (como en Argentina, Chile y Uruguay), la hegemonía católica en América Latina ha comenzado a debilitarse <span class="citation" data-cites="valenzuela_creen_2013">[@valenzuela_creen_2013]</span>. Este cambio en el panorama religioso podría tener implicancias importantes para la cohesión social en la región, particularmente si como se ha observado en el caso chileno, el debilitamiento de las identidades religiosas tradicionales se ha asociado a procesos de individuación y de desafección institucional <span class="citation" data-cites="bravovega_religious_2024 cortesparedes_autonomia_2022">[@bravovega_religious_2024; @cortesparedes_autonomia_2022]</span>.</p>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<p>A partir de la literatura revisada y considerando el contexto latinoamericano caracterizado por i) un bajo crecimiento económico acompañado de altos niveles de desigualdad <span class="citation" data-cites="undp_trapped_2023">[@undp_trapped_2023]</span>; ii) una limitada capacidad institucional y una gobernanza poco efectiva <span class="citation" data-cites="salazar-xirinachs_repensar_2023">[@salazar-xirinachs_repensar_2023]</span>; y iii) un aumento relativo y absoluto de los flujos migratorios interregionales, junto con el surgimiento de tensiones sociales asociadas a estos movimientos <span class="citation" data-cites="stefoni_panorama_2018 castillo_social_2023">[@stefoni_panorama_2018; @castillo_social_2023]</span>, proponemos las siguientes hipótesis:</p>
<ul>
<li><p><strong>H1</strong>: Los países con mayor desarrollo económico presentarán mayores niveles de cohesión social.</p></li>
<li><p><strong>H2</strong>: En países con mayor desigualdad y menores niveles educativo el impacto positivo del crecimiento económico sobre la cohesión social será más limitado.</p></li>
<li><p><strong>H3</strong>: En países con una mayor gobernanza presentarán mayores niveles de cohesión social.</p></li>
<li><p><strong>H4</strong>: En países con mayores niveles de diversidad étnica y cultural, la cohesión social será menor. De tal modo, los países con una mayor proporción de migrantes y con una menor cantidad de católicos presentarán menores niveles de cohesión social.</p></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>